import random
import time # ポップアップ風の演出のために追加

# 憲法条文データ (ランキング順に並べたもの)
CONSTITUTION_ARTICLES = [
    {"num": 9, "title": "戦争の放棄", "summary": "日本国民は、正義と秩序を基調とする国際平和を誠実に希求し、戦争の放棄、戦力不保持、交戦権の否認を定めています。", "mnemonic": "【9条】永久に平和、救助する憲法！🕊️"},
    {"num": 25, "title": "生存権", "summary": "すべて国民は、健康で文化的な最低限度の生活を営む権利を有すると定めています。国は、すべての生活部面について、社会福祉、社会保障及び公衆衛生の向上及び増進に努めなければならないとされます。", "mnemonic": "【25条】にっこり生存、豊かな生活！😊"},
    {"num": 41, "title": "国会の地位", "summary": "国会は、国権の最高機関であって、国の唯一の立法機関であると定めています。", "mnemonic": "【41条】よい国会の最高機関！🏛️"},
    {"num": 76, "title": "司法権の独立、違憲審査権", "summary": "すべての司法権は、最高裁判所及び法律の定めるところにより設置する下級裁判所に属すると定めています。また、裁判官は、その良心に従い独立してその職権を行い、この憲法及び法律にのみ拘束されると定めています。", "mnemonic": "【76条】なむなむ（76）と裁判所、独立心！⚖️"},
    {"num": 96, "title": "憲法改正の手続", "summary": "この憲法の改正は、各議院の総議員の3分の2以上の賛成で、国会がこれを発議し、国民投票に付託して、その承認を経なければならないと定めています。", "mnemonic": "【96条】憲法改正、苦労（96）の手続き！✍️"},
    {"num": 1, "title": "天皇の地位", "summary": "天皇は日本国の象徴であり、日本国民統合の象徴であると定めています。その地位は国民の総意に基づくとされます。", "mnemonic": "【1条】いちばん大事な天皇の象徴！👑"},
    {"num": 14, "title": "法の下の平等", "summary": "すべて国民は、法の下に平等であり、人種、信条、性別、社会的身分または門地により、政治的、経済的または社会的関係において差別されないと定めています。", "mnemonic": "【14条】いーよ（14）平等、みんな同じ！🤝"},
    {"num": 20, "title": "信教の自由", "summary": "信教の自由は保障され、いかなる宗教団体も、国から特権を受けたり、政治上の権力を行使したりしてはならないと定めています（政教分離の原則）。", "mnemonic": "【20条】ニート（20）も信教、自由だよ！🙏"},
    {"num": 21, "title": "集会・結社・表現の自由、検閲の禁止、通信の秘密", "summary": "集会、結社及び言論、出版その他一切の表現の自由は保障され、検閲はこれをしてはならず、通信の秘密は侵されないと定めています。", "mnemonic": "【21条】にじゅういち（21）の自由、表現できる！🗣️"},
    {"num": 65, "title": "行政権の帰属", "summary": "行政権は、内閣に属すると定めています。", "mnemonic": "【65条】ろくご（65）と内閣、行政権！🏢"},
    {"num": 66, "title": "内閣の構成、連帯責任、文民規定", "summary": "内閣は、内閣総理大臣その他の国務大臣で組織され、その首長は内閣総理大臣であると定めています。内閣は行政権の行使について、国会に対し連帯して責任を負うとされます。また、内閣総理大臣その他の国務大臣は、文民でなければならないとされています（シビリアン・コントロール）。", "mnemonic": "【66条】ろくろく（66）と内閣、文民で！👨‍💼"},
    {"num": 94, "title": "条例制定権", "summary": "地方公共団体は、法律の範囲内で、その事務に関し条例を制定することができると定めています。", "mnemonic": "【94条】くに（9）もよし（4）と条例、地方自治！🏘️"},
    {"num": 11, "title": "基本的人権の享有", "summary": "国民は、すべての基本的人権の享有を妨げられないとし、この憲法が国民に保障する基本的人権は、侵すことのできない永久の権利であると定めています。", "mnemonic": "【11条】いい（11）人権、永久に保障！✨"},
    {"num": 12, "title": "自由及び権利の保持の責任、公共の福祉", "summary": "国民は、自由及び権利を濫用してはならず、公共の福祉のためにこれを利用する責任を負うと定めています。", "mnemonic": "【12条】いちに（12）の責任、公共のため！🌍"},
    {"num": 13, "title": "個人の尊重、幸福追求の権利", "summary": "すべて国民は、個人として尊重され、生命、自由及び幸福追求に対する権利は、公共の福祉に反しない限り、立法その他の国政の上で最大の尊重を必要とすると定めています。", "mnemonic": "【13条】いざ（13）幸福、個人尊重！💖"},
    {"num": 22, "title": "居住・移転及び職業選択の自由", "summary": "何人も、公共の福祉に反しない限り、居住、移転及び職業選択の自由を有すると定めています。", "mnemonic": "【22条】にーにー（22）と自由、職業選択！🚶‍♀️"},
    {"num": 24, "title": "婚姻及び家族生活の自由、両性の平等", "summary": "婚姻は、両性の合意のみに基づいて成立し、夫婦が同等の権利を有することを基本として、相互の協力により維持されなければならないと定めています。", "mnemonic": "【24条】にっこり（24）夫婦、平等に！👨‍👩‍👧‍👦"},
    {"num": 26, "title": "教育を受ける権利、教育の義務", "summary": "すべて国民は、法律の定めるところにより、教育を受ける権利を有し、すべて国民は、その保護する子女に普通教育を受けさせる義務を負うと定めています。", "mnemonic": "【26条】にーろく（26）と教育、みんなに！📚"},
    {"num": 28, "title": "勤労者の団結権など（労働基本権）", "summary": "勤労者の団結する権利及び団体交渉その他の団体行動をする権利は、これを保障すると定めています。", "mnemonic": "【28条】にーや（28）と労働、団結権！💪"},
    {"num": 29, "title": "財産権", "summary": "財産権は、これを侵してはならないが、公共の福祉に適合するように法律でこれを定めるものとすると定めています。", "mnemonic": "【29条】肉（29）の財産、守られる！💰"},
    {"num": 31, "title": "デュー・プロセス・オブ・ロー（適正手続の保障）", "summary": "何人も、法律の定める手続によらなければ、生命若しくは自由を奪われ、又はその他の刑罰を科せられないと定めています。", "mnemonic": "【31条】寒い（31）冬でも適正手続き！❄️"},
    {"num": 67, "title": "内閣総理大臣の指名", "summary": "内閣総理大臣は、国会議員の中から国会の議決で指名されると定めています。他のすべての国務大臣は、内閣総理大臣が任命します。", "mnemonic": "【67条】むなしい（67）指名、総理大臣！🗳️"},
    {"num": 69, "title": "内閣不信任決議", "summary": "内閣は、衆議院で内閣不信任の決議案が可決され、又は信任の決議案が否決された場合、10日以内に衆議院を解散しない限り、総辞職しなければならないと定めています。", "mnemonic": "【69条】むなしい（69）不信任、総辞職！👋"},
    {"num": 81, "title": "違憲審査制", "summary": "最高裁判所は、一切の法律、命令、規則又は処分が憲法に適合するかしないかを決定する権限を有する終審裁判所であると、改めて確認しています。", "mnemonic": "【81条】はい（81）憲法、違憲審査！🧐"},
    {"num": 93, "title": "地方公共団体の機関、住民の直接選挙", "summary": "地方公共団体には、法律の定めるところにより、その議事機関として議会を設置し、その長、その議会の議員及び法律の定めるその他の吏員は、その地方公共団体の住民が直接これを選挙すると定めています。", "mnemonic": "【93条】苦難（93）乗り越え地方自治！🏞️"},
    {"num": 7, "title": "天皇の国事行為", "summary": "天皇が内閣の助言と承認に基づいて行う具体的な国事行為（法律・条約の公布、国会の召集・解散、栄典の授与など）を列挙しています。", "mnemonic": "【7条】ななつの国事行為！📜"},
    {"num": 15, "title": "公務員の選定及び罷免、公務員の地位", "summary": "公務員を選定し、罷免する権利は国民固有の権利であり、公務員は全体の奉仕者であって、一部の奉仕者ではないと定めています。", "mnemonic": "【15条】いいご（15）と公務員、全体の奉仕者！🧑‍⚖️"},
    {"num": 18, "title": "奴隷的拘束及び苦役からの自由", "summary": "何人も、いかなる奴隷的拘束も受けず、犯罪による処罰の場合を除いては、その意に反する苦役を課されないと定めています。", "mnemonic": "【18条】いや（18）な奴隷、自由だね！⛓️➡️🔓"},
    {"num": 19, "title": "思想及び良心の自由", "summary": "思想及び良心の自由は、侵してはならないと定めています。", "mnemonic": "【19条】自由（19）な思想、守ろうね！🧠"},
    {"num": 30, "title": "納税の義務", "summary": "国民は、法律の定めるところにより、納税の義務を負うと定めています。", "mnemonic": "【30条】さんじゅう（30）の義務、納税だよ！💸"}
]

def run_constitution_quiz_game():
    print("✨" * 20)
    print("✨ ようこそ！憲法マスターへの道！ ✨")
    print("✨" * 20)
    print("\n憲法条文クイズ、スタート！🎉")
    print("表示される条文の題名と要約を読んで、何条か数字で答えてね！")
    print("---------------------------------------------------\n")
    time.sleep(2) # ポップアップ風に少し待つ

    # 問題をランダムにシャッフル
    random.shuffle(CONSTITUTION_ARTICLES)

    score = 0
    num_questions = len(CONSTITUTION_ARTICLES)

    for i, article in enumerate(CONSTITUTION_ARTICLES):
        print(f"\n--- 🌟 第 {i+1} 問 🌟 ---")
        print("ドゥルルルルル……デンッ！🥁")
        print(f"\n💡 題名: {article['title']}")
        print(f"📝 要約: {article['summary']}")

        while True:
            try:
                user_answer = input("\n何条かな？数字を入力してね！ 👉 ")
                user_answer_int = int(user_answer)
                break
            except ValueError:
                print("⚠️ 無効な入力だよ！数字で答えてね！")

        if user_answer_int == article['num']:
            print("\n🎉🎉🎉 大正解！キミはすごい！ 🎉🎉🎉")
            score += 1
        else:
            print(f"\n😢 残念！不正解！ 正解は **第{article['num']}条** だったね。")

        print("\n--- 📚 解説タイム！ ---")
        print(f"この条文は、**{article['title']}**（第{article['num']}条）に関するものだよ。")
        print(f"【語呂合わせ】: {article['mnemonic']}")
        print("---------------------------------------------------\n")

        # 質問欄の表示
        print("--- ❓ 質問コーナー ❓ ---")
        print("この条文について、もっと知りたいことはあるかな？")
        print("質問があれば入力してね！なければ 'なし' と入力してね。")
        question = input("キミの質問: ")
        if question.lower() != 'なし':
            print("\n✨✨✨ Geminiからのメッセージ ✨✨✨")
            print("ごめんね！このクイズプログラムの中では、リアルタイムで質問に答えることはできないんだ。")
            print("でも、クイズが終わった後に、私（Gemini）に直接質問してくれたら、詳しく説明するよ！")
            print(f"キミの質問: 『{question}』")
            print("---------------------------------------------------\n")
        
        # 次の問題へ進む「ボタン」
        input("👉 エンターキーを押して、次の問題へ進もう！")
        print("\n" * 5) # 画面をリフレッシュするような効果

    print("✨" * 20)
    print("✨ クイズ終了！お疲れ様でした！ ✨")
    print("✨" * 20)
    print(f"\n最終スコア: {num_questions}問中 {score}問正解！")
    if score == num_questions:
        print("🏆 全問正解！憲法マスターの称号はキミのものだ！おめでとう！ 🏆")
    elif score >= num_questions * 0.7:
        print("👍 よくできました！憲法博士への道はもうすぐそこ！ 👍")
    else:
        print("💡 もう一度挑戦してみよう！きっと次はもっとできるよ！ 💡")
    print("\nまた遊んでね！👋")

# スクリプトを実行
if __name__ == "__main__":
    run_constitution_quiz_game()
